---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
---

<Layout title="BASE64ç¼–è§£ç å·¥å…· - æ•°å­—èŠ±å›­" description="BASE64ç¼–ç å’Œè§£ç å·¥å…·ï¼Œæ”¯æŒæ–‡æœ¬ç¼–è§£ç ã€æ–‡ä»¶æ”¯æŒã€æ‰¹é‡å¤„ç†å’Œæ ¼å¼éªŒè¯">
  <Header />
  
  <main class="main">
    <div class="container">
      <header class="page-header">
        <h1 class="page-title">BASE64ç¼–è§£ç å·¥å…·</h1>
        <p class="page-description">
          ä¸“ä¸šçš„BASE64ç¼–ç å’Œè§£ç å·¥å…·ï¼Œæ”¯æŒæ–‡æœ¬ã€æ–‡ä»¶ã€æ‰¹é‡å¤„ç†å’Œæ ¼å¼éªŒè¯
        </p>
      </header>

      <!-- BASE64ç¼–è§£ç ä¸»ç•Œé¢ -->
      <section class="encoder-section">
        <div class="encoder-card industrial-border">
          <!-- æ“ä½œæ¨¡å¼é€‰æ‹© -->
          <div class="mode-selector">
            <div class="mode-tabs">
              <button class="mode-tab active" data-mode="text" id="text-mode-tab">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14,2 14,8 20,8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10,9 9,9 8,9"></polyline>
                </svg>
                æ–‡æœ¬ç¼–è§£ç 
              </button>
              <button class="mode-tab" data-mode="file" id="file-mode-tab">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                  <polyline points="13,2 13,9 20,9"></polyline>
                </svg>
                æ–‡ä»¶ç¼–è§£ç 
              </button>
              <button class="mode-tab" data-mode="batch" id="batch-mode-tab">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                  <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                  <path d="M9 14l2 2 4-4"></path>
                </svg>
                æ‰¹é‡å¤„ç†
              </button>
            </div>
          </div>

          <!-- æ–‡æœ¬ç¼–è§£ç æ¨¡å¼ -->
          <div class="processing-mode" id="text-mode">
            <div class="input-section">
              <div class="input-group">
                <label for="text-input" class="input-label">è¾“å…¥æ–‡æœ¬:</label>
                <textarea 
                  id="text-input" 
                  class="text-textarea" 
                  placeholder="è¯·è¾“å…¥éœ€è¦ç¼–ç æˆ–è§£ç çš„æ–‡æœ¬..."
                  rows="6"
                ></textarea>
                <div class="input-info">
                  <span class="char-count" id="text-char-count">0 å­—ç¬¦</span>
                  <span class="encoding-info" id="text-encoding-info">UTF-8</span>
                </div>
              </div>

              <div class="action-buttons">
                <button class="action-btn encode-btn" id="text-encode-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="16,18 22,12 16,6"></polyline>
                    <polyline points="8,6 2,12 8,18"></polyline>
                  </svg>
                  BASE64ç¼–ç 
                </button>
                <button class="action-btn decode-btn" id="text-decode-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="8,18 2,12 8,6"></polyline>
                    <polyline points="16,6 22,12 16,18"></polyline>
                  </svg>
                  BASE64è§£ç 
                </button>
                <button class="action-btn clear-btn" id="text-clear-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="3,6 5,6 21,6"></polyline>
                    <path d="M19,6v14a2,2 0,0 1,-2,2H7a2,2 0,0 1,-2,-2V6m3,0V4a2,2 0,0 1,2,-2h4a2,2 0,0 1,2,2v2"></path>
                  </svg>
                  æ¸…ç©º
                </button>
              </div>
            </div>

            <div class="output-section">
              <div class="output-group">
                <label for="text-output" class="output-label">
                  å¤„ç†ç»“æœ:
                  <button class="copy-result-btn" id="copy-text-result-btn" title="å¤åˆ¶ç»“æœ">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                </label>
                <textarea 
                  id="text-output" 
                  class="text-textarea output-textarea" 
                  placeholder="å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."
                  rows="6"
                  readonly
                ></textarea>
                <div class="output-info">
                  <span class="char-count" id="text-output-char-count">0 å­—ç¬¦</span>
                  <span class="validation-status" id="text-validation-status"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- æ–‡ä»¶ç¼–è§£ç æ¨¡å¼ -->
          <div class="processing-mode hidden" id="file-mode">
            <div class="file-input-section">
              <div class="file-upload-area" id="file-upload-area">
                <div class="upload-icon">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7,10 12,15 17,10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                </div>
                <div class="upload-text">
                  <p class="upload-title">ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</p>
                  <p class="upload-subtitle">æ”¯æŒæ‰€æœ‰æ–‡ä»¶ç±»å‹ï¼Œæœ€å¤§ 10MB</p>
                </div>
                <input type="file" id="file-input" class="file-input" />
              </div>

              <div class="file-info hidden" id="file-info">
                <div class="file-details">
                  <div class="file-icon">ğŸ“„</div>
                  <div class="file-meta">
                    <div class="file-name" id="file-name"></div>
                    <div class="file-size" id="file-size"></div>
                    <div class="file-type" id="file-type"></div>
                  </div>
                  <button class="remove-file-btn" id="remove-file-btn" title="ç§»é™¤æ–‡ä»¶">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>

              <div class="file-actions">
                <button class="action-btn encode-btn" id="file-encode-btn" disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="16,18 22,12 16,6"></polyline>
                    <polyline points="8,6 2,12 8,18"></polyline>
                  </svg>
                  ç¼–ç æ–‡ä»¶
                </button>
                <button class="action-btn decode-btn" id="file-decode-btn" disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="8,18 2,12 8,6"></polyline>
                    <polyline points="16,6 22,12 16,18"></polyline>
                  </svg>
                  è§£ç æ–‡ä»¶
                </button>
              </div>
            </div>

            <div class="file-output-section">
              <div class="output-group">
                <label for="file-output" class="output-label">
                  æ–‡ä»¶å¤„ç†ç»“æœ:
                  <div class="file-output-actions">
                    <button class="copy-result-btn" id="copy-file-result-btn" title="å¤åˆ¶ç»“æœ">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                      </svg>
                    </button>
                    <button class="download-result-btn" id="download-result-btn" title="ä¸‹è½½ç»“æœ">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7,10 12,15 17,10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                      </svg>
                    </button>
                  </div>
                </label>
                <textarea 
                  id="file-output" 
                  class="text-textarea output-textarea file-output-textarea" 
                  placeholder="æ–‡ä»¶å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."
                  rows="10"
                  readonly
                ></textarea>
                <div class="output-info">
                  <span class="char-count" id="file-output-char-count">0 å­—ç¬¦</span>
                  <span class="validation-status" id="file-validation-status"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡å¤„ç†æ¨¡å¼ -->
          <div class="processing-mode hidden" id="batch-mode">
            <div class="batch-input-section">
              <div class="input-group">
                <label for="batch-input" class="input-label">æ‰¹é‡è¾“å…¥ (æ¯è¡Œä¸€ä¸ªæ–‡æœ¬):</label>
                <textarea 
                  id="batch-input" 
                  class="text-textarea batch-textarea" 
                  placeholder="è¯·è¾“å…¥å¤šä¸ªæ–‡æœ¬ï¼Œæ¯è¡Œä¸€ä¸ª..."
                  rows="8"
                ></textarea>
                <div class="batch-info">
                  <span class="line-count" id="batch-line-count">0 è¡Œ</span>
                  <span class="valid-count" id="batch-valid-count">0 ä¸ªæœ‰æ•ˆé¡¹</span>
                </div>
              </div>

              <div class="batch-actions">
                <button class="action-btn batch-encode-btn" id="batch-encode-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="16,18 22,12 16,6"></polyline>
                    <polyline points="8,6 2,12 8,18"></polyline>
                  </svg>
                  æ‰¹é‡ç¼–ç 
                </button>
                <button class="action-btn batch-decode-btn" id="batch-decode-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="8,18 2,12 8,6"></polyline>
                    <polyline points="16,6 22,12 16,18"></polyline>
                  </svg>
                  æ‰¹é‡è§£ç 
                </button>
                <button class="action-btn clear-batch-btn" id="clear-batch-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <polyline points="3,6 5,6 21,6"></polyline>
                    <path d="M19,6v14a2,2 0,0 1,-2,2H7a2,2 0,0 1,-2,-2V6m3,0V4a2,2 0,0 1,2,-2h4a2,2 0,0 1,2,2v2"></path>
                  </svg>
                  æ¸…ç©º
                </button>
              </div>
            </div>

            <div class="batch-output-section">
              <div class="output-group">
                <label for="batch-output" class="output-label">
                  æ‰¹é‡å¤„ç†ç»“æœ:
                  <button class="copy-batch-btn" id="copy-batch-btn" title="å¤åˆ¶æ‰€æœ‰ç»“æœ">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                </label>
                <textarea 
                  id="batch-output" 
                  class="text-textarea batch-textarea output-textarea" 
                  placeholder="æ‰¹é‡å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."
                  rows="8"
                  readonly
                ></textarea>
                <div class="batch-result-info">
                  <span class="processed-count" id="processed-count">å·²å¤„ç†: 0</span>
                  <span class="success-count" id="success-count">æˆåŠŸ: 0</span>
                  <span class="error-count" id="error-count">å¤±è´¥: 0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- ç¼–ç é€‰é¡¹ -->
          <div class="encoding-options">
            <h3 class="options-title">ç¼–ç é€‰é¡¹</h3>
            <div class="options-grid">
              <label class="option-item">
                <input type="checkbox" id="url-safe-base64" />
                <span class="option-text">URLå®‰å…¨ç¼–ç </span>
                <span class="option-desc">ä½¿ç”¨ - å’Œ _ æ›¿æ¢ + å’Œ /</span>
              </label>
              <label class="option-item">
                <input type="checkbox" id="remove-padding" />
                <span class="option-text">ç§»é™¤å¡«å……å­—ç¬¦</span>
                <span class="option-desc">ç§»é™¤ç»“å°¾çš„ = å­—ç¬¦</span>
              </label>
              <label class="option-item">
                <input type="checkbox" id="line-breaks" />
                <span class="option-text">æ·»åŠ æ¢è¡Œç¬¦</span>
                <span class="option-desc">æ¯76ä¸ªå­—ç¬¦æ·»åŠ æ¢è¡Œ</span>
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- å¸¸ç”¨ç¤ºä¾‹ -->
      <section class="examples-section">
        <div class="examples-content industrial-border">
          <h2 class="examples-title">å¸¸ç”¨ç¤ºä¾‹</h2>
          <div class="examples-grid">
            <div class="example-item">
              <h3 class="example-title">ä¸­æ–‡æ–‡æœ¬ç¼–ç </h3>
              <div class="example-demo">
                <div class="example-input">
                  <strong>åŸå§‹:</strong> ä½ å¥½ï¼Œä¸–ç•Œï¼
                </div>
                <div class="example-output">
                  <strong>ç¼–ç :</strong> 5L2g5aW977yM5LiW55WM77yB
                </div>
              </div>
              <button class="try-example-btn" data-input="ä½ å¥½ï¼Œä¸–ç•Œï¼">è¯•è¯•è¿™ä¸ª</button>
            </div>

            <div class="example-item">
              <h3 class="example-title">JSONæ•°æ®ç¼–ç </h3>
              <div class="example-demo">
                <div class="example-input">
                  <strong>åŸå§‹:</strong> {"name":"å¼ ä¸‰","age":25}
                </div>
                <div class="example-output">
                  <strong>ç¼–ç :</strong> eyJuYW1lIjoi5byg5LiJIiwiYWdlIjoyNX0=
                </div>
              </div>
              <button class="try-example-btn" data-input='{"name":"å¼ ä¸‰","age":25}'>è¯•è¯•è¿™ä¸ª</button>
            </div>

            <div class="example-item">
              <h3 class="example-title">URLç¼–ç ç¤ºä¾‹</h3>
              <div class="example-demo">
                <div class="example-input">
                  <strong>åŸå§‹:</strong> https://example.com/api?q=æµ‹è¯•
                </div>
                <div class="example-output">
                  <strong>ç¼–ç :</strong> aHR0cHM6Ly9leGFtcGxlLmNvbS9hcGk_cT3mtYvor5U=
                </div>
              </div>
              <button class="try-example-btn" data-input="https://example.com/api?q=æµ‹è¯•">è¯•è¯•è¿™ä¸ª</button>
            </div>
          </div>
        </div>
      </section>

      <!-- åŠŸèƒ½è¯´æ˜ */
      <section class="features-section">
        <div class="features-content industrial-border">
          <h2 class="features-title">åŠŸèƒ½ç‰¹ç‚¹</h2>
          <div class="features-grid">
            <div class="feature-item">
              <div class="feature-icon">ğŸ“</div>
              <h3>æ–‡æœ¬ç¼–è§£ç </h3>
              <p>æ”¯æŒä»»æ„æ–‡æœ¬çš„BASE64ç¼–ç å’Œè§£ç ï¼Œå®Œç¾å¤„ç†ä¸­æ–‡å­—ç¬¦</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ“</div>
              <h3>æ–‡ä»¶æ”¯æŒ</h3>
              <p>æ”¯æŒä»»æ„æ–‡ä»¶ç±»å‹çš„ç¼–è§£ç ï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€æ–‡æ¡£ã€éŸ³é¢‘ç­‰</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ“‹</div>
              <h3>æ‰¹é‡å¤„ç†</h3>
              <p>æ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ªæ–‡æœ¬ï¼Œæé«˜å·¥ä½œæ•ˆç‡</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">âœ…</div>
              <h3>æ ¼å¼éªŒè¯</h3>
              <p>è‡ªåŠ¨éªŒè¯BASE64æ ¼å¼ï¼Œè¯†åˆ«æœ‰æ•ˆå’Œæ— æ•ˆçš„ç¼–ç </p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ”§</div>
              <h3>å¤šç§é€‰é¡¹</h3>
              <p>æ”¯æŒURLå®‰å…¨ç¼–ç ã€ç§»é™¤å¡«å……ã€æ·»åŠ æ¢è¡Œç­‰é€‰é¡¹</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ”’</div>
              <h3>æœ¬åœ°å¤„ç†</h3>
              <p>æ‰€æœ‰å¤„ç†åœ¨æœ¬åœ°å®Œæˆï¼Œä¿æŠ¤ä½ çš„æ•°æ®éšç§</p>
            </div>
          </div>
        </div>
      </section>

      <!-- ä½¿ç”¨è¯´æ˜ -->
      <section class="usage-section">
        <div class="usage-content industrial-border">
          <h2 class="usage-title">ä½¿ç”¨è¯´æ˜</h2>
          <div class="usage-list">
            <div class="usage-item">
              <strong>BASE64ç¼–ç :</strong> å°†ä»»æ„æ•°æ®è½¬æ¢ä¸ºBASE64æ ¼å¼ï¼Œå¸¸ç”¨äºæ•°æ®ä¼ è¾“å’Œå­˜å‚¨ã€‚
            </div>
            <div class="usage-item">
              <strong>BASE64è§£ç :</strong> å°†BASE64ç¼–ç çš„æ•°æ®è¿˜åŸä¸ºåŸå§‹æ ¼å¼ã€‚
            </div>
            <div class="usage-item">
              <strong>æ–‡ä»¶å¤„ç†:</strong> æ”¯æŒæ‹–æ‹½ä¸Šä¼ æ–‡ä»¶ï¼Œè‡ªåŠ¨è¯»å–æ–‡ä»¶å†…å®¹è¿›è¡Œç¼–è§£ç ã€‚
            </div>
            <div class="usage-item">
              <strong>æ‰¹é‡æ“ä½œ:</strong> åœ¨æ‰¹é‡æ¨¡å¼ä¸‹ï¼Œæ¯è¡Œè¾“å…¥ä¸€ä¸ªæ–‡æœ¬ï¼Œå·¥å…·ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰æœ‰æ•ˆçš„å†…å®¹ã€‚
            </div>
            <div class="usage-item">
              <strong>æ ¼å¼éªŒè¯:</strong> å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹BASE64æ ¼å¼çš„æœ‰æ•ˆæ€§ï¼Œå¹¶åœ¨å¤„ç†ç»“æœä¸­æ ‡æ³¨éªŒè¯çŠ¶æ€ã€‚
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>
</Layout>

<style>
  .main {
    min-height: calc(100vh - 80px);
    padding: 2rem 0;
  }

  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .page-title {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    font-family: var(--font-mono);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .page-description {
    font-size: 1.125rem;
    color: var(--color-secondary);
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
    font-family: var(--font-sans);
  }

  .encoder-section {
    margin-bottom: 3rem;
  }

  .encoder-card {
    background-color: var(--color-card);
    padding: 2rem;
    max-width: 1000px;
    margin: 0 auto;
  }

  /* æ¨¡å¼é€‰æ‹©å™¨ */
  .mode-selector {
    margin-bottom: 2rem;
  }

  .mode-tabs {
    display: flex;
    gap: 0.5rem;
    background-color: var(--color-code-bg);
    padding: 0.5rem;
    border-radius: 4px;
    border: 1px solid var(--color-border);
  }

  .mode-tab {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: none;
    border: none;
    color: var(--color-secondary);
    font-family: var(--font-mono);
    font-size: 0.85rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 2px;
    flex: 1;
    justify-content: center;
  }

  .mode-tab:hover {
    color: var(--color-text);
    background-color: var(--color-hover);
  }

  .mode-tab.active {
    background-color: var(--color-accent);
    color: var(--color-bg);
  }

  /* å¤„ç†æ¨¡å¼ */
  .processing-mode {
    display: block;
  }

  .processing-mode.hidden {
    display: none;
  }

  /* è¾“å…¥è¾“å‡ºåŒºåŸŸ */
  .input-section,
  .output-section,
  .batch-input-section,
  .batch-output-section,
  .file-input-section,
  .file-output-section {
    margin-bottom: 2rem;
  }

  .input-group,
  .output-group {
    position: relative;
  }

  .input-label,
  .output-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: var(--font-mono);
    font-size: 0.9rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-text);
  }

  .copy-result-btn,
  .copy-batch-btn {
    background: none;
    border: 1px solid var(--color-border);
    color: var(--color-secondary);
    padding: 0.25rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .copy-result-btn:hover,
  .copy-batch-btn:hover {
    color: var(--color-accent);
    background-color: var(--color-hover);
  }

  .copy-result-btn.copied,
  .copy-batch-btn.copied {
    color: #28a745;
    border-color: #28a745;
  }

  .text-textarea {
    width: 100%;
    padding: 1rem;
    font-family: var(--font-mono);
    font-size: 0.9rem;
    background-color: var(--color-code-bg);
    border: 2px solid var(--color-border);
    border-radius: 4px;
    color: var(--color-text);
    line-height: 1.5;
    resize: vertical;
    outline: none;
    transition: border-color 0.2s ease;
  }

  .text-textarea:focus {
    border-color: var(--color-accent);
  }

  .text-textarea.output-textarea {
    background-color: var(--color-hover);
    cursor: text;
  }

  .batch-textarea {
    min-height: 200px;
  }

  .file-output-textarea {
    min-height: 250px;
    font-size: 0.8rem;
    word-break: break-all;
  }

  /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
  .file-upload-area {
    border: 2px dashed var(--color-border);
    border-radius: 8px;
    padding: 3rem 2rem;
    text-align: center;
    background-color: var(--color-code-bg);
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    margin-bottom: 1rem;
  }

  .file-upload-area:hover {
    border-color: var(--color-accent);
    background-color: var(--color-hover);
  }

  .file-upload-area.dragover {
    border-color: var(--color-accent);
    background-color: var(--color-hover);
    transform: scale(1.02);
  }

  .upload-icon {
    color: var(--color-secondary);
    margin-bottom: 1rem;
  }

  .upload-title {
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: 0.5rem;
  }

  .upload-subtitle {
    font-family: var(--font-sans);
    font-size: 0.875rem;
    color: var(--color-secondary);
    margin: 0;
  }

  .file-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
  }

  /* æ–‡ä»¶ä¿¡æ¯æ˜¾ç¤º */
  .file-info {
    background-color: var(--color-code-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: 1rem;
    margin-bottom: 1rem;
  }

  .file-details {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .file-icon {
    font-size: 2rem;
    flex-shrink: 0;
  }

  .file-meta {
    flex: 1;
  }

  .file-name {
    font-family: var(--font-mono);
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: 0.25rem;
  }

  .file-size,
  .file-type {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--color-secondary);
  }

  .remove-file-btn {
    background: none;
    border: 1px solid var(--color-border);
    color: var(--color-secondary);
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 4px;
    flex-shrink: 0;
  }

  .remove-file-btn:hover {
    color: #dc3545;
    border-color: #dc3545;
    background-color: var(--color-hover);
  }

  .file-output-actions {
    display: flex;
    gap: 0.5rem;
  }

  .download-result-btn {
    background: none;
    border: 1px solid var(--color-border);
    color: var(--color-secondary);
    padding: 0.25rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .download-result-btn:hover {
    color: var(--color-accent);
    background-color: var(--color-hover);
  }

  /* ä¿¡æ¯æ˜¾ç¤º */
  .input-info,
  .output-info,
  .batch-info,
  .batch-result-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.5rem;
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--color-secondary);
  }

  .char-count,
  .line-count,
  .valid-count,
  .processed-count,
  .success-count,
  .error-count {
    font-weight: 500;
  }

  .encoding-info,
  .validation-status {
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .validation-status.valid,
  .success-count {
    color: #28a745;
  }

  .validation-status.invalid,
  .error-count {
    color: #dc3545;
  }

  /* æ“ä½œæŒ‰é’® */
  .action-buttons,
  .batch-actions,
  .file-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin: 1.5rem 0;
  }

  .action-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background-color: var(--color-card);
    border: 2px solid var(--color-border);
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 4px;
  }

  .action-btn:hover:not(:disabled) {
    background-color: var(--color-hover);
    border-color: var(--color-accent);
    color: var(--color-accent);
    transform: translateY(-1px);
  }

  .action-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }

  .encode-btn:hover:not(:disabled),
  .batch-encode-btn:hover:not(:disabled) {
    background-color: #007bff;
    border-color: #007bff;
    color: white;
  }

  .decode-btn:hover:not(:disabled),
  .batch-decode-btn:hover:not(:disabled) {
    background-color: #28a745;
    border-color: #28a745;
    color: white;
  }

  .clear-btn:hover:not(:disabled),
  .clear-batch-btn:hover:not(:disabled) {
    background-color: #dc3545;
    border-color: #dc3545;
    color: white;
  }

  /* ç¼–ç é€‰é¡¹ */
  .encoding-options {
    border-top: 2px solid var(--color-border);
    padding-top: 2rem;
    margin-top: 2rem;
  }

  .options-title {
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-accent);
  }

  .options-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .option-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 1rem;
    background-color: var(--color-code-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .option-item:hover {
    background-color: var(--color-hover);
  }

  .option-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--color-accent);
    margin-bottom: 0.5rem;
  }

  .option-text {
    font-family: var(--font-mono);
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--color-text);
  }

  .option-desc {
    font-family: var(--font-sans);
    font-size: 0.75rem;
    color: var(--color-secondary);
  }

  /* ç¤ºä¾‹åŒºåŸŸ */
  .examples-section {
    margin-bottom: 3rem;
  }

  .examples-content {
    background-color: var(--color-card);
    padding: 2rem;
  }

  .examples-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
    font-family: var(--font-mono);
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-accent);
  }

  .examples-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .example-item {
    background-color: var(--color-code-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: 1.5rem;
  }

  .example-title {
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-text);
  }

  .example-demo {
    margin-bottom: 1rem;
  }

  .example-input,
  .example-output {
    margin-bottom: 0.75rem;
    padding: 0.75rem;
    background-color: var(--color-card);
    border: 1px solid var(--color-border);
    border-radius: 2px;
    font-family: var(--font-mono);
    font-size: 0.8rem;
    line-height: 1.4;
    word-break: break-all;
  }

  .example-input strong,
  .example-output strong {
    color: var(--color-accent);
    display: block;
    margin-bottom: 0.25rem;
  }

  .try-example-btn {
    width: 100%;
    padding: 0.5rem;
    background-color: var(--color-accent);
    color: var(--color-bg);
    border: none;
    border-radius: 4px;
    font-family: var(--font-mono);
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .try-example-btn:hover {
    background-color: var(--color-text);
    transform: translateY(-1px);
  }

  /* åŠŸèƒ½ç‰¹ç‚¹ */
  .features-section {
    margin-bottom: 3rem;
  }

  .features-content {
    background-color: var(--color-card);
    padding: 2rem;
  }

  .features-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
    font-family: var(--font-mono);
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-accent);
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .feature-item {
    text-align: center;
    padding: 1rem;
    background-color: var(--color-code-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
  }

  .feature-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
  }

  .feature-item h3 {
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .feature-item p {
    color: var(--color-secondary);
    font-size: 0.85rem;
    line-height: 1.5;
    margin: 0;
    font-family: var(--font-sans);
  }

  /* ä½¿ç”¨è¯´æ˜ */
  .usage-section {
    margin-bottom: 2rem;
  }

  .usage-content {
    background-color: var(--color-card);
    padding: 2rem;
  }

  .usage-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
    font-family: var(--font-mono);
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--color-accent);
  }

  .usage-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .usage-item {
    padding: 1rem;
    background-color: var(--color-code-bg);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    font-family: var(--font-sans);
    line-height: 1.6;
    color: var(--color-secondary);
  }

  .usage-item strong {
    color: var(--color-accent);
    font-weight: 700;
  }

  .hidden {
    display: none !important;
  }

  /* å“åº”å¼è®¾è®¡ */
  @media (max-width: 768px) {
    .page-title {
      font-size: 2rem;
    }

    .page-description {
      font-size: 1rem;
    }

    .encoder-card {
      padding: 1.5rem;
    }

    .mode-tabs {
      flex-direction: column;
    }

    .action-buttons,
    .batch-actions,
    .file-actions {
      flex-direction: column;
      gap: 0.75rem;
    }

    .action-btn {
      justify-content: center;
    }

    .options-grid {
      grid-template-columns: 1fr;
    }

    .examples-grid {
      grid-template-columns: 1fr;
    }

    .features-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .features-content,
    .usage-content,
    .examples-content {
      padding: 1.5rem;
    }

    .file-upload-area {
      padding: 2rem 1rem;
    }

    .file-details {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .file-output-actions {
      flex-direction: column;
      gap: 0.25rem;
    }
  }
</style>

<script>
  // BASE64ç¼–è§£ç å·¥å…·ç±»
  class Base64EncoderDecoder {
    constructor() {
      this.initElements();
      this.bindEvents();
      this.currentMode = 'text';
      this.currentFile = null;
    }

    initElements() {
      // æ¨¡å¼åˆ‡æ¢
      this.textModeTab = document.getElementById('text-mode-tab');
      this.fileModeTab = document.getElementById('file-mode-tab');
      this.batchModeTab = document.getElementById('batch-mode-tab');
      this.textMode = document.getElementById('text-mode');
      this.fileMode = document.getElementById('file-mode');
      this.batchMode = document.getElementById('batch-mode');

      // æ–‡æœ¬å¤„ç†æ¨¡å¼å…ƒç´ 
      this.textInput = document.getElementById('text-input');
      this.textOutput = document.getElementById('text-output');
      this.textEncodeBtn = document.getElementById('text-encode-btn');
      this.textDecodeBtn = document.getElementById('text-decode-btn');
      this.textClearBtn = document.getElementById('text-clear-btn');
      this.copyTextResultBtn = document.getElementById('copy-text-result-btn');

      // æ–‡ä»¶å¤„ç†æ¨¡å¼å…ƒç´ 
      this.fileUploadArea = document.getElementById('file-upload-area');
      this.fileInput = document.getElementById('file-input');
      this.fileInfo = document.getElementById('file-info');
      this.fileName = document.getElementById('file-name');
      this.fileSize = document.getElementById('file-size');
      this.fileType = document.getElementById('file-type');
      this.removeFileBtn = document.getElementById('remove-file-btn');
      this.fileEncodeBtn = document.getElementById('file-encode-btn');
      this.fileDecodeBtn = document.getElementById('file-decode-btn');
      this.fileOutput = document.getElementById('file-output');
      this.copyFileResultBtn = document.getElementById('copy-file-result-btn');
      this.downloadResultBtn = document.getElementById('download-result-btn');

      // æ‰¹é‡å¤„ç†æ¨¡å¼å…ƒç´ 
      this.batchInput = document.getElementById('batch-input');
      this.batchOutput = document.getElementById('batch-output');
      this.batchEncodeBtn = document.getElementById('batch-encode-btn');
      this.batchDecodeBtn = document.getElementById('batch-decode-btn');
      this.clearBatchBtn = document.getElementById('clear-batch-btn');
      this.copyBatchBtn = document.getElementById('copy-batch-btn');

      // çŠ¶æ€æ˜¾ç¤ºå…ƒç´ 
      this.textCharCount = document.getElementById('text-char-count');
      this.textOutputCharCount = document.getElementById('text-output-char-count');
      this.textEncodingInfo = document.getElementById('text-encoding-info');
      this.textValidationStatus = document.getElementById('text-validation-status');
      this.fileOutputCharCount = document.getElementById('file-output-char-count');
      this.fileValidationStatus = document.getElementById('file-validation-status');
      this.batchLineCount = document.getElementById('batch-line-count');
      this.batchValidCount = document.getElementById('batch-valid-count');
      this.processedCount = document.getElementById('processed-count');
      this.successCount = document.getElementById('success-count');
      this.errorCount = document.getElementById('error-count');

      // ç¼–ç é€‰é¡¹
      this.urlSafeBase64 = document.getElementById('url-safe-base64');
      this.removePadding = document.getElementById('remove-padding');
      this.lineBreaks = document.getElementById('line-breaks');

      // ç¤ºä¾‹æŒ‰é’®
      this.tryExampleBtns = document.querySelectorAll('.try-example-btn');
    }

    bindEvents() {
      // æ¨¡å¼åˆ‡æ¢
      this.textModeTab.addEventListener('click', () => this.switchMode('text'));
      this.fileModeTab.addEventListener('click', () => this.switchMode('file'));
      this.batchModeTab.addEventListener('click', () => this.switchMode('batch'));

      // æ–‡æœ¬å¤„ç†æ¨¡å¼äº‹ä»¶
      this.textInput.addEventListener('input', () => this.updateTextStatus());
      this.textEncodeBtn.addEventListener('click', () => this.encodeText());
      this.textDecodeBtn.addEventListener('click', () => this.decodeText());
      this.textClearBtn.addEventListener('click', () => this.clearText());
      this.copyTextResultBtn.addEventListener('click', () => this.copyTextResult());

      // æ–‡ä»¶å¤„ç†æ¨¡å¼äº‹ä»¶
      this.fileUploadArea.addEventListener('click', () => this.fileInput.click());
      this.fileUploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
      this.fileUploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
      this.fileUploadArea.addEventListener('drop', (e) => this.handleFileDrop(e));
      this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
      this.removeFileBtn.addEventListener('click', () => this.removeFile());
      this.fileEncodeBtn.addEventListener('click', () => this.encodeFile());
      this.fileDecodeBtn.addEventListener('click', () => this.decodeFile());
      this.copyFileResultBtn.addEventListener('click', () => this.copyFileResult());
      this.downloadResultBtn.addEventListener('click', () => this.downloadResult());

      // æ‰¹é‡å¤„ç†æ¨¡å¼äº‹ä»¶
      this.batchInput.addEventListener('input', () => this.updateBatchStatus());
      this.batchEncodeBtn.addEventListener('click', () => this.batchEncode());
      this.batchDecodeBtn.addEventListener('click', () => this.batchDecode());
      this.clearBatchBtn.addEventListener('click', () => this.clearBatch());
      this.copyBatchBtn.addEventListener('click', () => this.copyBatchResults());

      // ç¤ºä¾‹æŒ‰é’®
      this.tryExampleBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          const input = e.target.getAttribute('data-input');
          this.loadExample(input);
        });
      });

      // åˆå§‹åŒ–çŠ¶æ€
      this.updateTextStatus();
      this.updateBatchStatus();
    }

    switchMode(mode) {
      this.currentMode = mode;
      
      // æ›´æ–°æ ‡ç­¾çŠ¶æ€
      document.querySelectorAll('.mode-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.processing-mode').forEach(mode => mode.classList.add('hidden'));
      
      if (mode === 'text') {
        this.textModeTab.classList.add('active');
        this.textMode.classList.remove('hidden');
      } else if (mode === 'file') {
        this.fileModeTab.classList.add('active');
        this.fileMode.classList.remove('hidden');
      } else if (mode === 'batch') {
        this.batchModeTab.classList.add('active');
        this.batchMode.classList.remove('hidden');
      }
    }

    updateTextStatus() {
      const input = this.textInput.value;
      const charCount = input.length;
      
      this.textCharCount.textContent = `${charCount} å­—ç¬¦`;
    }

    updateBatchStatus() {
      const input = this.batchInput.value;
      const lines = input.split('\n').filter(line => line.trim());
      const validLines = lines.filter(line => line.trim().length > 0);
      
      this.batchLineCount.textContent = `${lines.length} è¡Œ`;
      this.batchValidCount.textContent = `${validLines.length} ä¸ªæœ‰æ•ˆé¡¹`;
    }

    encodeText() {
      const input = this.textInput.value;
      if (!input) return;

      try {
        const result = this.performBase64Encode(input);
        this.textOutput.value = result;
        this.updateTextOutputStatus(result, true);
      } catch (error) {
        this.textOutput.value = `ç¼–ç å¤±è´¥: ${error.message}`;
        this.updateTextOutputStatus('', false);
      }
    }

    decodeText() {
      const input = this.textInput.value.trim();
      if (!input) return;

      try {
        const result = this.performBase64Decode(input);
        this.textOutput.value = result;
        this.updateTextOutputStatus(result, true);
      } catch (error) {
        this.textOutput.value = `è§£ç å¤±è´¥: ${error.message}`;
        this.updateTextOutputStatus('', false);
      }
    }

    performBase64Encode(input) {
      // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºUTF-8å­—èŠ‚
      const utf8Bytes = new TextEncoder().encode(input);
      
      // è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
      let binaryString = '';
      for (let i = 0; i < utf8Bytes.length; i++) {
        binaryString += String.fromCharCode(utf8Bytes[i]);
      }
      
      // BASE64ç¼–ç 
      let result = btoa(binaryString);
      
      // åº”ç”¨ç¼–ç é€‰é¡¹
      if (this.urlSafeBase64.checked) {
        result = result.replace(/\+/g, '-').replace(/\//g, '_');
      }
      
      if (this.removePadding.checked) {
        result = result.replace(/=/g, '');
      }
      
      if (this.lineBreaks.checked) {
        result = result.replace(/(.{76})/g, '$1\n');
      }
      
      return result;
    }

    performBase64Decode(input) {
      let processedInput = input.replace(/\s/g, ''); // ç§»é™¤æ‰€æœ‰ç©ºç™½å­—ç¬¦
      
      // å¤„ç†URLå®‰å…¨ç¼–ç 
      if (this.urlSafeBase64.checked || processedInput.includes('-') || processedInput.includes('_')) {
        processedInput = processedInput.replace(/-/g, '+').replace(/_/g, '/');
      }
      
      // æ·»åŠ å¡«å……å­—ç¬¦
      while (processedInput.length % 4) {
        processedInput += '=';
      }
      
      // éªŒè¯BASE64æ ¼å¼
      if (!this.isValidBase64(processedInput)) {
        throw new Error('æ— æ•ˆçš„BASE64æ ¼å¼');
      }
      
      try {
        // BASE64è§£ç 
        const binaryString = atob(processedInput);
        
        // è½¬æ¢ä¸ºUTF-8å­—ç¬¦ä¸²
        const bytes = new Uint8Array(binaryString.length);
        for (let i = 0; i < binaryString.length; i++) {
          bytes[i] = binaryString.charCodeAt(i);
        }
        
        return new TextDecoder('utf-8').decode(bytes);
      } catch (error) {
        throw new Error('è§£ç å¤±è´¥ï¼Œå¯èƒ½åŒ…å«æ— æ•ˆçš„BASE64åºåˆ—');
      }
    }

    updateTextOutputStatus(result, success) {
      const charCount = result.length;
      this.textOutputCharCount.textContent = `${charCount} å­—ç¬¦`;
      
      if (success && result) {
        const isValid = this.isValidBase64(result);
        this.textValidationStatus.textContent = isValid ? 'æœ‰æ•ˆBASE64' : 'æ–‡æœ¬å†…å®¹';
        this.textValidationStatus.className = `validation-status ${isValid ? 'valid' : 'partial'}`;
      } else {
        this.textValidationStatus.textContent = success ? '' : 'å¤„ç†å¤±è´¥';
        this.textValidationStatus.className = `validation-status ${success ? '' : 'invalid'}`;
      }
    }

    clearText() {
      this.textInput.value = '';
      this.textOutput.value = '';
      this.updateTextStatus();
      this.updateTextOutputStatus('', true);
    }

    // æ–‡ä»¶å¤„ç†æ–¹æ³•
    handleDragOver(e) {
      e.preventDefault();
      this.fileUploadArea.classList.add('dragover');
    }

    handleDragLeave(e) {
      e.preventDefault();
      this.fileUploadArea.classList.remove('dragover');
    }

    handleFileDrop(e) {
      e.preventDefault();
      this.fileUploadArea.classList.remove('dragover');
      
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        this.processFile(files[0]);
      }
    }

    handleFileSelect(e) {
      const files = e.target.files;
      if (files.length > 0) {
        this.processFile(files[0]);
      }
    }

    processFile(file) {
      // æ£€æŸ¥æ–‡ä»¶å¤§å° (10MBé™åˆ¶)
      if (file.size > 10 * 1024 * 1024) {
        alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 10MB');
        return;
      }

      this.currentFile = file;
      
      // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
      this.fileName.textContent = file.name;
      this.fileSize.textContent = this.formatFileSize(file.size);
      this.fileType.textContent = file.type || 'æœªçŸ¥ç±»å‹';
      
      this.fileInfo.classList.remove('hidden');
      this.fileEncodeBtn.disabled = false;
      this.fileDecodeBtn.disabled = false;
    }

    removeFile() {
      this.currentFile = null;
      this.fileInfo.classList.add('hidden');
      this.fileEncodeBtn.disabled = true;
      this.fileDecodeBtn.disabled = true;
      this.fileOutput.value = '';
      this.fileInput.value = '';
      this.updateFileOutputStatus('', true);
    }

    async encodeFile() {
      if (!this.currentFile) return;

      try {
        const arrayBuffer = await this.currentFile.arrayBuffer();
        const bytes = new Uint8Array(arrayBuffer);
        
        // è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
        let binaryString = '';
        for (let i = 0; i < bytes.length; i++) {
          binaryString += String.fromCharCode(bytes[i]);
        }
        
        // BASE64ç¼–ç 
        let result = btoa(binaryString);
        
        // åº”ç”¨ç¼–ç é€‰é¡¹
        if (this.urlSafeBase64.checked) {
          result = result.replace(/\+/g, '-').replace(/\//g, '_');
        }
        
        if (this.removePadding.checked) {
          result = result.replace(/=/g, '');
        }
        
        if (this.lineBreaks.checked) {
          result = result.replace(/(.{76})/g, '$1\n');
        }
        
        this.fileOutput.value = result;
        this.updateFileOutputStatus(result, true);
      } catch (error) {
        this.fileOutput.value = `æ–‡ä»¶ç¼–ç å¤±è´¥: ${error.message}`;
        this.updateFileOutputStatus('', false);
      }
    }

    async decodeFile() {
      if (!this.currentFile) return;

      try {
        const text = await this.currentFile.text();
        const result = this.performBase64Decode(text.trim());
        
        this.fileOutput.value = result;
        this.updateFileOutputStatus(result, true);
      } catch (error) {
        this.fileOutput.value = `æ–‡ä»¶è§£ç å¤±è´¥: ${error.message}`;
        this.updateFileOutputStatus('', false);
      }
    }

    updateFileOutputStatus(result, success) {
      const charCount = result.length;
      this.fileOutputCharCount.textContent = `${charCount} å­—ç¬¦`;
      
      if (success && result) {
        const isValid = this.isValidBase64(result);
        this.fileValidationStatus.textContent = isValid ? 'æœ‰æ•ˆBASE64' : 'æ–‡æœ¬å†…å®¹';
        this.fileValidationStatus.className = `validation-status ${isValid ? 'valid' : 'partial'}`;
      } else {
        this.fileValidationStatus.textContent = success ? '' : 'å¤„ç†å¤±è´¥';
        this.fileValidationStatus.className = `validation-status ${success ? '' : 'invalid'}`;
      }
    }

    // æ‰¹é‡å¤„ç†æ–¹æ³•
    batchEncode() {
      const input = this.batchInput.value.trim();
      if (!input) return;

      const lines = input.split('\n').filter(line => line.trim());
      const results = [];
      let successCount = 0;
      let errorCount = 0;

      lines.forEach((line, index) => {
        const trimmedLine = line.trim();
        if (!trimmedLine) return;

        try {
          const encoded = this.performBase64Encode(trimmedLine);
          results.push(encoded);
          successCount++;
        } catch (error) {
          results.push(`[é”™è¯¯] ${trimmedLine} - ${error.message}`);
          errorCount++;
        }
      });

      this.batchOutput.value = results.join('\n');
      this.updateBatchResults(lines.length, successCount, errorCount);
    }

    batchDecode() {
      const input = this.batchInput.value.trim();
      if (!input) return;

      const lines = input.split('\n').filter(line => line.trim());
      const results = [];
      let successCount = 0;
      let errorCount = 0;

      lines.forEach((line, index) => {
        const trimmedLine = line.trim();
        if (!trimmedLine) return;

        try {
          const decoded = this.performBase64Decode(trimmedLine);
          results.push(decoded);
          successCount++;
        } catch (error) {
          results.push(`[é”™è¯¯] ${trimmedLine} - ${error.message}`);
          errorCount++;
        }
      });

      this.batchOutput.value = results.join('\n');
      this.updateBatchResults(lines.length, successCount, errorCount);
    }

    updateBatchResults(processed, success, error) {
      this.processedCount.textContent = `å·²å¤„ç†: ${processed}`;
      this.successCount.textContent = `æˆåŠŸ: ${success}`;
      this.errorCount.textContent = `å¤±è´¥: ${error}`;
    }

    clearBatch() {
      this.batchInput.value = '';
      this.batchOutput.value = '';
      this.updateBatchStatus();
      this.updateBatchResults(0, 0, 0);
    }

    // å¤åˆ¶å’Œä¸‹è½½æ–¹æ³•
    async copyTextResult() {
      const result = this.textOutput.value;
      if (!result) return;

      try {
        await navigator.clipboard.writeText(result);
        this.showCopyFeedback(this.copyTextResultBtn);
      } catch (error) {
        this.fallbackCopy(result, this.copyTextResultBtn);
      }
    }

    async copyFileResult() {
      const result = this.fileOutput.value;
      if (!result) return;

      try {
        await navigator.clipboard.writeText(result);
        this.showCopyFeedback(this.copyFileResultBtn);
      } catch (error) {
        this.fallbackCopy(result, this.copyFileResultBtn);
      }
    }

    async copyBatchResults() {
      const results = this.batchOutput.value;
      if (!results) return;

      try {
        await navigator.clipboard.writeText(results);
        this.showCopyFeedback(this.copyBatchBtn);
      } catch (error) {
        this.fallbackCopy(results, this.copyBatchBtn);
      }
    }

    downloadResult() {
      const result = this.fileOutput.value;
      if (!result) return;

      const blob = new Blob([result], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `base64_result_${Date.now()}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    fallbackCopy(text, button) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      
      try {
        document.execCommand('copy');
        this.showCopyFeedback(button);
      } catch (error) {
        console.error('å¤åˆ¶å¤±è´¥:', error);
      }
      
      document.body.removeChild(textArea);
    }

    showCopyFeedback(button) {
      const originalHTML = button.innerHTML;
      
      button.classList.add('copied');
      button.innerHTML = `
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <polyline points="20,6 9,17 4,12"></polyline>
        </svg>
      `;
      
      setTimeout(() => {
        button.classList.remove('copied');
        button.innerHTML = originalHTML;
      }, 2000);
    }

    loadExample(input) {
      this.switchMode('text');
      this.textInput.value = input;
      this.updateTextStatus();
      this.encodeText();
    }

    isValidBase64(str) {
      try {
        // ç§»é™¤ç©ºç™½å­—ç¬¦
        const cleaned = str.replace(/\s/g, '');
        
        // æ£€æŸ¥å­—ç¬¦æ˜¯å¦éƒ½æ˜¯æœ‰æ•ˆçš„BASE64å­—ç¬¦
        const base64Regex = /^[A-Za-z0-9+/]*={0,2}$/;
        if (!base64Regex.test(cleaned)) {
          return false;
        }
        
        // æ£€æŸ¥é•¿åº¦æ˜¯å¦æ˜¯4çš„å€æ•°
        if (cleaned.length % 4 !== 0) {
          return false;
        }
        
        // å°è¯•è§£ç 
        atob(cleaned);
        return true;
      } catch (e) {
        return false;
      }
    }

    formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
  }

  // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
  document.addEventListener('DOMContentLoaded', () => {
    new Base64EncoderDecoder();
  });
</script>